<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>مسابقة عز الدين - الإصدار اللانهائي</title>
    <style>
        body { background: #010a1c; color: white; font-family: sans-serif; text-align: center; margin: 0; padding: 0; }
        .scoreboard { display: flex; justify-content: space-around; background: #001f3f; padding: 15px; border-bottom: 3px solid #ffcc00; position: sticky; top: 0; z-index: 100; box-shadow: 0 2px 10px rgba(0,0,0,0.5); }
        .team-box { border: 2px solid #ffcc00; padding: 10px; border-radius: 10px; min-width: 120px; background: #00152b; }
        .score { font-size: 30px; color: #ffcc00; font-weight: bold; }
        .grid-container { display: flex; gap: 12px; overflow-x: auto; padding: 20px; -webkit-overflow-scrolling: touch; }
        .column { background: #001f3f; padding: 10px; border: 2px solid #ffcc00; border-radius: 8px; min-width: 210px; flex-shrink: 0; }
        .category-name { font-weight: bold; font-size: 20px; margin-bottom: 12px; color: #ffcc00; border-bottom: 2px solid #ffcc00; padding-bottom: 5px; }
        .card { background: #111; color: #ffcc00; margin: 10px 0; padding: 20px; cursor: pointer; font-size: 22px; font-weight: bold; border-radius: 6px; border: 1px solid #ffcc00; width: 100%; transition: 0.2s; }
        .card:hover { background: #222; transform: scale(1.02); }
        .card.used { opacity: 0.1; cursor: default; pointer-events: none; background: #000; border-color: #444; }
        .modal { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.95); align-items:center; justify-content:center; z-index: 1000; }
        .modal-box { background: white; color: black; padding: 30px; border-radius: 15px; width: 90%; max-width: 500px; box-shadow: 0 0 20px #ffcc00; }
        .btn { padding: 15px; cursor: pointer; border-radius: 6px; border: none; font-weight: bold; font-size: 18px; width: 100%; margin-top: 10px; color: white; }
    </style>
</head>
<body>

    <div class="scoreboard">
        <div class="team-box"><div>الفريق 1</div><div id="score1" class="score">0</div></div>
        <div class="team-box"><div>الفريق 2</div><div id="score2" class="score">0</div></div>
    </div>
    
    <div class="grid-container" id="board"></div>

    <div id="modal" class="modal">
        <div class="modal-box">
            <h2 id="q-text" style="margin-bottom:20px; line-height:1.4;"></h2>
            <div id="a-text" style="display:none; color: #155724; background: #d4edda; padding: 20px; margin: 20px 0; font-weight: bold; border-radius: 10px; border: 1px solid #c3e6cb; font-size: 20px;"></div>
            <button class="btn" style="background: #28a745;" onclick="document.getElementById('a-text').style.display='block'">إظهار الإجابة</button>
            <button class="btn" style="background: #007bff;" onclick="addPoints(1)">نقطة للفريق 1</button>
            <button class="btn" style="background: #dc3545;" onclick="addPoints(2)">نقطة للفريق 2</button>
            <button class="btn" style="background: #6c757d;" onclick="closeModal()">إغلاق</button>
        </div>
    </div>

    <script>
        let s1 = 0, s2 = 0, currentP = 0, currentID = "";
        // نظام الذاكرة لمنع تكرار أي سؤال ظهر لك سابقاً
        let solved = JSON.parse(localStorage.getItem('ez_final_ultra_v1')) || [];

        const bank = [
            // --- باب الحارة (جديد) ---
            { c: "باب الحارة", p: 200, q: "ما هو لقب الأخ الأصغر لمعتز؟", a: "خاطر", id: "bh13" },
            { c: "باب الحارة", p: 400, q: "من مثل دور (أبو جاسم)؟", a: "نزار أبو حجر", id: "bh14" },
            { c: "باب الحارة", p: 600, q: "ما اسم زوجة عصام الأولى؟", a: "لطفية", id: "bh15" },
            { c: "باب الحارة", p: 200, q: "من كان يصرخ (آآآخ يا باطل)؟", a: "أبو شهاب", id: "bh16" },
            { c: "باب الحارة", p: 400, q: "ما هي مهنة 'أبو النار'؟", a: "حداد", id: "bh17" },
            { c: "باب الحارة", p: 600, q: "من كان يقول 'فشرت ولاك'؟", a: "معتز", id: "bh18" },

            // --- معلومات عامة (جديد) ---
            { c: "معلومات", p: 200, q: "ما هو لون الزمرد؟", a: "الأخضر", id: "g10" },
            { c: "معلومات", p: 400, q: "كم عدد قارات العالم؟", a: "7 قارات", id: "g11" },
            { c: "معلومات", p: 600, q: "أين تقع ساعة بيغ بن؟", a: "لندن", id: "g12" },
            { c: "معلومات", p: 200, q: "أضخم حيوان في العالم؟", a: "الحوت الأزرق", id: "g13" },
            { c: "معلومات", p: 400, q: "في أي بلد يوجد تمثال الحرية؟", a: "أمريكا", id: "g14" },
            { c: "معلومات", p: 600, q: "ما هي عملة اليابان؟", a: "الين", id: "g15" },

            // --- ألغاز (جديد) ---
            { c: "ألغاز", p: 200, q: "شيء يحمل طعامه فوق رأسه؟", a: "القلم", id: "q7" },
            { c: "ألغاز", p: 400, q: "شيء تذبحه وتبكي عليه؟", a: "البصل", id: "q8" },
            { c: "ألغاز", p: 600, q: "له أرجل ولكنه لا يمشي؟", a: "الكرسي", id: "q9" },
            { c: "ألغاز", p: 200, q: "يمتلكه الفقير ويحتاجه الغني؟", a: "الجوع", id: "q10" },
            { c: "ألغاز", p: 400, q: "ينبض بلا قلب؟", a: "الساعة", id: "q11" },
            { c: "ألغاز", p: 600, q: "يدخل مبلولاً ويخرج ناشفاً؟", a: "الخبز", id: "q12" },

            // --- إسلاميات (جديد) ---
            { c: "إسلاميات", p: 200, q: "ما القبلة الأولى للمسلمين؟", a: "بيت المقدس", id: "i7" },
            { c: "إسلاميات", p: 400, q: "ما اسم ناقة الرسول ﷺ؟", a: "القصواء", id: "i8" },
            { c: "إسلاميات", p: 600, q: "القائد الذي فتح الأندلس؟", a: "طارق بن زياد", id: "i9" },
            { c: "إسلاميات", p: 200, q: "كم عدد أركان الإسلام؟", a: "خمسة", id: "i10" },
            { c: "إسلاميات", p: 400, q: "أقصر سورة في القرآن؟", a: "الكوثر", id: "i11" },
            { c: "إسلاميات", p: 600, q: "أول مؤذن في الإسلام؟", a: "بلال بن رباح", id: "i12" }
        ];

        const cats = ["باب الحارة", "معلومات", "ألغاز", "إسلاميات"];

        function buildBoard() {
            const board = document.getElementById('board');
            board.innerHTML = "";
            
            cats.forEach(cat => {
                const col = document.createElement('div');
                col.className = 'column';
                col.innerHTML = `<div class="category-name">${cat}</div>`;
                
                let sessionUsed = []; 

                [200, 200, 400, 400, 600, 600].forEach(p => {
                    const btn = document.createElement('button');
                    btn.className = 'card';
                    
                    // تصفية الأسئلة لضمان عدم التكرار نهائياً
                    const available = bank.filter(q => q.c === cat && q.p === p && !solved.includes(q.id) && !sessionUsed.includes(q.id));
                    
                    if(available.length > 0) {
                        const q = available[Math.floor(Math.random() * available.length)];
                        sessionUsed.push(q.id);
                        btn.innerText = p;
                        btn.onclick = () => {
                            currentP = p; currentID = q.id;
                            document.getElementById('q-text').innerText = q.q;
                            document.getElementById('a-text').innerText = q.a;
                            document.getElementById('a-text').style.display = 'none';
                            document.getElementById('modal').style.display = 'flex';
                            btn.classList.add('used');
                        };
                    } else {
                        // لمنع ظهور undefined وضمان استمرارية اللعبة
                        btn.innerText = "تم";
                        btn.classList.add('used');
                    }
                    col.appendChild(btn);
                });
                board.appendChild(col);
            });
        }

        function addPoints(team) {
            if(team === 1) { s1 += currentP; document.getElementById('score1').innerText = s1; }
            else { s2 += currentP; document.getElementById('score2').innerText = s2; }
            
            // حفظ بصمة السؤال لمنع ظهوره للأبد
            solved.push(currentID);
            localStorage.setItem('ez_final_ultra_v1', JSON.stringify(solved));
            closeModal();
        }

        function closeModal() { document.getElementById('modal').style.display = 'none'; }
        
        buildBoard();
    </script>
</body>
</html>
