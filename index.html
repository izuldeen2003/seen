<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ØªØ­Ø¯ÙŠ Ø³ÙŠÙ† Ø¬ÙŠÙ… AI - Ø§Ù„Ù†Ø³Ø®Ø© Ø§Ù„Ù…Ø¹ØªÙ…Ø¯Ø©</title>
    <style>
        :root { --gold: #fcc201; --blue: #060ce9; --dark-blue: #02056e; }
        * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
        body { background: var(--dark-blue); color: white; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; margin: 0; text-align: center; overflow-x: hidden; }
        .setup-container { padding: 20px; }
        .cat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 20px; }
        .cat-item { background: #000; border: 2px solid var(--gold); padding: 18px; border-radius: 12px; cursor: pointer; font-weight: bold; transition: 0.3s; font-size: 1.1rem; }
        .cat-item.active { background: var(--gold); color: black; transform: scale(1.05); }
        .btn-start { background: var(--gold); color: black; border: none; padding: 15px 40px; font-size: 1.3rem; font-weight: bold; border-radius: 50px; margin-top: 25px; display: none; width: 85%; cursor: pointer; box-shadow: 0 5px #b88e00; }
        .game-header { background: #000; padding: 15px; border-bottom: 3px solid var(--gold); display: flex; justify-content: space-around; position: sticky; top: 0; z-index: 100; font-size: 1.2rem; }
        .game-board { display: grid; grid-template-columns: 1fr; gap: 15px; padding: 15px; }
        .cat-section { background: rgba(0,0,0,0.4); border-radius: 15px; padding: 12px; border: 1px solid rgba(252, 194, 1, 0.2); }
        .cat-name { color: var(--gold); font-weight: bold; margin-bottom: 12px; font-size: 1.4rem; text-shadow: 1px 1px #000; }
        .vals-row { display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; }
        .val-cell { background: var(--blue); border: 2px solid #000; height: 80px; display: flex; align-items: center; justify-content: center; font-size: 1.8rem; font-weight: bold; color: var(--gold); border-radius: 10px; cursor: pointer; box-shadow: 0 4px #000; }
        .val-cell.used { opacity: 0.1; pointer-events: none; box-shadow: none; }
        .modal { position: fixed; inset: 0; background: var(--dark-blue); display: none; flex-direction: column; align-items: center; justify-content: center; padding: 25px; z-index: 200; }
        .timer { font-size: 4.5rem; color: #ff3e3e; font-weight: bold; margin-bottom: 10px; }
        .q-text { font-size: 2rem; margin: 25px 0; line-height: 1.5; font-weight: bold; padding: 0 10px; }
        .a-text { color: var(--gold); font-size: 1.7rem; margin-bottom: 30px; border: 2px dashed var(--gold); padding: 15px; border-radius: 15px; width: 95%; background: rgba(0,0,0,0.3); }
        .score-btn { padding: 18px; font-size: 1.2rem; border-radius: 12px; border: none; font-weight: bold; margin: 8px; cursor: pointer; color: white; flex: 1; }
    </style>
</head>
<body>

<div id="setupScreen" class="setup-container">
    <h1 style="color:var(--gold); font-size: 2.5rem;">ØªØ­Ø¯ÙŠ Ø³ÙŠÙ† Ø¬ÙŠÙ… AI</h1>
    <p style="font-size: 1.2rem;">Ø§Ø®ØªØ± 6 ÙØ¦Ø§Øª Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø©:</p>
    <div id="catGrid" class="cat-grid"></div>
    <button id="startBtn" class="btn-start" onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„ØªØ­Ø¯ÙŠ ğŸš€</button>
</div>

<div id="gameScreen" style="display:none">
    <div class="game-header">
        <div>ÙØ±ÙŠÙ‚ 1: <span id="s1" style="color:var(--gold)">0</span></div>
        <div id="turnInfo">Ø¯ÙˆØ±: <span style="color:var(--gold)">ÙØ±ÙŠÙ‚ 1</span></div>
        <div>ÙØ±ÙŠÙ‚ 2: <span id="s2" style="color:var(--gold)">0</span></div>
    </div>
    <div id="board" class="game-board"></div>
</div>

<div id="qModal" class="modal">
    <div id="timer" class="timer">20</div>
    <div id="qText" class="q-text">Ø¬Ø§Ø±ÙŠ ØªØ­Ø¶ÙŠØ± Ø§Ù„Ø³Ø¤Ø§Ù„...</div>
    <div id="aText" class="a-text" style="display:none"></div>
    <div id="modalBtns">
        <button class="btn-start" style="display:inline-block; width: auto;" onclick="revealAnswer()">ÙƒØ´Ù Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© ğŸ”“</button>
    </div>
    <div id="scoreBtns" style="display:none; width: 100%; display: flex;">
        <button class="score-btn" style="background:#28a745" onclick="addPoints(1)">ÙØ±ÙŠÙ‚ 1 âœ…</button>
        <button class="score-btn" style="background:#28a745" onclick="addPoints(2)">ÙØ±ÙŠÙ‚ 2 âœ…</button>
        <button class="score-btn" style="background:#dc3545" onclick="closeModal()">Ø®Ø·Ø£ âŒ</button>
    </div>
</div>

<script>
    const G_API = 'AIzaSyB_D649NZ6bMTB98CEpV1gcSzZiaz4uuZk';
    const cats = ["Ø¨Ø§Ø¨ Ø§Ù„Ø­Ø§Ø±Ø©", "Ø±ÙŠØ§Ø¶Ø©", "ØªØ§Ø±ÙŠØ®", "Ø¹ÙˆØ§ØµÙ…", "Ø£Ù…Ø«Ø§Ù„ Ø´Ø¹Ø¨ÙŠØ©", "Ø£Ù†Ù…ÙŠ", "ÙØ¶Ø§Ø¡", "Ø¹Ù„ÙˆÙ…", "Ø³ÙŠØ§Ø±Ø§Øª", "Ø£ÙƒÙ„Ø§Øª", "Ø¬ØºØ±Ø§ÙÙŠØ§", "ØªÙ‚Ù†ÙŠØ©"];
    
    // Ù‚Ø§Ø¹Ø¯Ø© Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù„Ø¶Ù…Ø§Ù† Ø¹Ø¯Ù… ØªÙƒØ±Ø§Ø± Ø§Ù„Ø£Ø³Ø¦Ù„Ø© ÙÙŠ Ø­Ø§Ù„ ÙØ´Ù„ Gemini
    const backupQuestions = {
        "Ø¨Ø§Ø¨ Ø§Ù„Ø­Ø§Ø±Ø©": [ {q: "Ù…Ù† Ù‡Ùˆ Ø­ÙƒÙŠÙ… Ø­Ø§Ø±Ø© Ø§Ù„Ø¶Ø¨Ø¹ØŸ", a: "Ø£Ø¨Ùˆ Ø¹ØµØ§Ù…"}, {q: "Ù…Ø§ Ø§Ø³Ù… Ø²ÙˆØ¬Ø© Ø§Ù„Ø¥Ø¯Ø¹Ø´Ø±ÙŠØŸ", a: "Ø£Ù… Ù…Ø¹Ø±ÙˆÙ"}, {q: "Ù…Ù† Ø§Ù„Ø°ÙŠ Ù‚ØªÙ„ ØµØ·ÙŠÙ Ø§Ù„Ø£Ø¹Ù…Ù‰ØŸ", a: "Ø£Ø¨Ùˆ Ø¹ØµØ§Ù…"} ],
        "Ø±ÙŠØ§Ø¶Ø©": [ {q: "Ù…Ù† Ù‡Ùˆ Ø§Ù„Ù‡Ø¯Ø§Ù Ø§Ù„ØªØ§Ø±ÙŠØ®ÙŠ Ù„ÙƒØ£Ø³ Ø§Ù„Ø¹Ø§Ù„Ù…ØŸ", a: "Ù…ÙŠØ±ÙˆØ³Ù„Ø§Ù ÙƒÙ„ÙˆØ²Ù‡"}, {q: "ÙƒÙ… Ø¹Ø¯Ø¯ Ù„Ø§Ø¹Ø¨ÙŠ ÙØ±ÙŠÙ‚ ÙƒØ±Ø© Ø§Ù„Ø³Ù„Ø©ØŸ", a: "5 Ù„Ø§Ø¹Ø¨ÙŠÙ†"}, {q: "Ø£ÙŠÙ† Ø£Ù‚ÙŠÙ…Øª Ø£ÙˆÙ„ Ø¨Ø·ÙˆÙ„Ø© ÙƒØ£Ø³ Ø¹Ø§Ù„Ù…ØŸ", a: "Ø§Ù„Ø£ÙˆØ±ÙˆØºÙˆØ§ÙŠ"} ],
        "ØªØ§Ø±ÙŠØ®": [ {q: "Ù…Ù† Ù‡Ùˆ ÙØ§ØªØ­ Ø§Ù„Ø£Ù†Ø¯Ù„Ø³ØŸ", a: "Ø·Ø§Ø±Ù‚ Ø¨Ù† Ø²ÙŠØ§Ø¯"}, {q: "ÙÙŠ Ø£ÙŠ Ø¹Ø§Ù… Ø¨Ø¯Ø£Øª Ø§Ù„Ø«ÙˆØ±Ø© Ø§Ù„ÙØ±Ù†Ø³ÙŠØ©ØŸ", a: "1789"}, {q: "Ù…Ù† Ø¨Ù†Ù‰ Ø§Ù„Ø£Ù‡Ø±Ø§Ù…Ø§ØªØŸ", a: "Ø§Ù„ÙØ±Ø§Ø¹Ù†Ø©"} ],
        "Ø£Ù…Ø«Ø§Ù„ Ø´Ø¹Ø¨ÙŠØ©": [ {q: "Ø£ÙƒÙ…Ù„ Ø§Ù„Ù…Ø«Ù„: Ø§Ù„Ù‚Ø±Ø¯ ÙÙŠ Ø¹ÙŠÙ† Ø£Ù…Ù‡...", a: "ØºØ²Ø§Ù„"}, {q: "Ø£ÙƒÙ…Ù„ Ø§Ù„Ù…Ø«Ù„: Ù…Ù† Ø­ÙØ± Ø­ÙØ±Ø© Ù„Ø£Ø®ÙŠÙ‡...", a: "ÙˆÙ‚Ø¹ ÙÙŠÙ‡Ø§"}, {q: "Ø£ÙƒÙ…Ù„ Ø§Ù„Ù…Ø«Ù„: Ø§Ù„ÙˆÙ‚Øª ÙƒØ§Ù„Ø³ÙŠÙ Ø¥Ù† Ù„Ù… ØªÙ‚Ø·Ø¹Ù‡...", a: "Ù‚Ø·Ø¹Ùƒ"} ]
    };

    let selected = []; let scores = [0, 0]; let turn = 1; let currentVal = 0; let clock;

    const grid = document.getElementById('catGrid');
    cats.forEach(c => {
        const div = document.createElement('div');
        div.className = 'cat-item';
        div.innerText = c;
        div.onclick = () => {
            if(div.classList.contains('active')) {
                div.classList.remove('active');
                selected = selected.filter(x => x !== c);
            } else if(selected.length < 6) {
                div.classList.add('active');
                selected.push(c);
            }
            document.getElementById('startBtn').style.display = selected.length === 6 ? 'inline-block' : 'none';
        };
        grid.appendChild(div);
    });

    function startGame() {
        document.getElementById('setupScreen').style.display = 'none';
        document.getElementById('gameScreen').style.display = 'block';
        const board = document.getElementById('board');
        selected.forEach(cat => {
            const sec = document.createElement('div');
            sec.className = 'cat-section';
            sec.innerHTML = `<div class="cat-name">${cat}</div><div class="vals-row">
                <div class="val-cell" onclick="ask('${cat}', 200, this)">200</div>
                <div class="val-cell" onclick="ask('${cat}', 400, this)">400</div>
                <div class="val-cell" onclick="ask('${cat}', 600, this)">600</div>
            </div>`;
            board.appendChild(sec);
        });
    }

    async function ask(cat, val, el) {
        el.classList.add('used');
        currentVal = val;
        document.getElementById('qModal').style.display = 'flex';
        document.getElementById('qText').innerText = "Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ù€ Gemini... ğŸ§ ";
        document.getElementById('aText').style.display = 'none';
        document.getElementById('modalBtns').style.display = 'inline-block';
        document.getElementById('scoreBtns').style.display = 'none';
        document.getElementById('timer').innerText = "20";

        try {
            // Ø·Ù„Ø¨ Ø°ÙƒÙŠ ÙˆÙ…ÙØµÙ„ Ù„Ø¶Ù…Ø§Ù† Ø£ÙØ¶Ù„ Ù†ØªÙŠØ¬Ø©
            const prompt = `Ø£Ù†Øª Ø®Ø¨ÙŠØ± Ù…Ø³Ø§Ø¨Ù‚Ø§Øª. Ø£Ø¹Ø·Ù†ÙŠ Ø³Ø¤Ø§Ù„Ø§Ù‹ ÙˆØ§Ø­Ø¯Ø§Ù‹ Ø¬Ø¯ÙŠØ¯Ø§Ù‹ ÙˆÙ…Ù…ÙŠØ²Ø§Ù‹ Ø¬Ø¯Ø§Ù‹ Ø¹Ù† "${cat}" Ø¨Ù…Ø³ØªÙˆÙ‰ ØµØ¹ÙˆØ¨Ø© ${val}/600. Ø§Ù„Ø±Ø¯ ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† Ø¨ØµÙŠØºØ© JSON ÙÙ‚Ø·: {"q":"Ù†Øµ Ø§Ù„Ø³Ø¤Ø§Ù„ Ù‡Ù†Ø§","a":"Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø© Ø§Ù„Ù…Ø®ØªØµØ±Ø©"}`;
            const url = `https://generativelanguage.googleapis.com/v1/models/gemini-1.5-flash:generateContent?key=${G_API}`;
            
            const response = await fetch(url, {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ contents: [{ parts: [{ text: prompt }] }] })
            });

            const data = await response.json();
            const text = data.candidates[0].content.parts[0].text;
            const jsonStr = text.substring(text.indexOf('{'), text.lastIndexOf('}') + 1);
            const res = JSON.parse(jsonStr);

            document.getElementById('qText').innerText = res.q;
            document.getElementById('aText').innerText = "Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: " + res.a;
            startTimer();
        } catch (e) {
            // ÙÙŠ Ø­Ø§Ù„ ÙØ´Ù„ GeminiØŒ Ù†Ø³ØªØ®Ø¯Ù… Ø§Ù„Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠØ© Ù„ÙƒÙŠ Ù„Ø§ ØªØªÙˆÙ‚Ù Ø§Ù„Ù„Ø¹Ø¨Ø©
            console.log("Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø³Ø¤Ø§Ù„ Ø§Ù„Ø§Ø­ØªÙŠØ§Ø·ÙŠ...");
            const fallback = backupQuestions[cat] ? backupQuestions[cat][Math.floor(Math.random() * backupQuestions[cat].length)] : {q: "Ø³Ø¤Ø§Ù„ Ø³Ø±ÙŠØ¹: Ù…Ø§ Ù‡ÙŠ Ø¹Ø§ØµÙ…Ø© Ø§Ù„Ø³Ø¹ÙˆØ¯ÙŠØ©ØŸ", a: "Ø§Ù„Ø±ÙŠØ§Ø¶"};
            document.getElementById('qText').innerText = fallback.q;
            document.getElementById('aText').innerText = "Ø§Ù„Ø¥Ø¬Ø§Ø¨Ø©: " + fallback.a;
            startTimer();
        }
    }

    function startTimer() {
        let s = 20;
        clearInterval(clock);
        clock = setInterval(() => {
            s--;
            document.getElementById('timer').innerText = s;
            if(s <= 0) { clearInterval(clock); revealAnswer(); }
        }, 1000);
    }

    function revealAnswer() {
        clearInterval(clock);
        document.getElementById('aText').style.display = 'block';
        document.getElementById('modalBtns').style.display = 'none';
        document.getElementById('scoreBtns').style.display = 'flex';
    }

    function addPoints(f) {
        scores[f-1] += currentVal;
        document.getElementById('s'+f).innerText = scores[f-1];
        turn = turn === 1 ? 2 : 1;
        document.getElementById('turnInfo').innerHTML = `Ø¯ÙˆØ±: <span style="color:var(--gold)">ÙØ±ÙŠÙ‚ ${turn}</span>`;
        closeModal();
    }

    function closeModal() {
        document.getElementById('qModal').style.display = 'none';
        clearInterval(clock);
    }
</script>
</body>
</html>
